#include "data_processor.h"
#include "sll.h"
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "stm32g4xx.h"
#include "stm32g4xx_hal.h"
#include <command_handler.h>

List *lp;

char mock_csv[] = "0.0332\n"
                  "0.0343\n"
                  "0.0351\n"
                  "0.0358\n"
                  "0.0366\n"
                  "0.0354\n"
                  "0.0347\n"
                  "0.0354\n"
                  "0.0354\n"
                  "0.0362\n"
                  "0.0351\n"
                  "0.0347\n"
                  "0.0351\n"
                  "0.0335\n"
                  "0.0347\n"
                  "0.0347\n"
                  "0.0339\n"
                  "0.0351\n"
                  "0.0358\n"
                  "0.0343\n"
                  "0.0347\n"
                  "0.0347\n"
                  "0.0347\n"
                  "0.0343\n"
                  "0.0339\n"
                  "0.0339\n"
                  "0.0332\n"
                  "0.0335\n"
                  "0.0316\n"
                  "0.0305\n"
                  "0.0297\n"
                  "0.0290\n"
                  "0.0293\n"
                  "0.0297\n"
                  "0.0297\n"
                  "0.0297\n"
                  "0.0293\n"
                  "0.0301\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0286\n"
                  "0.0282\n"
                  "0.0274\n"
                  "0.0290\n"
                  "0.0286\n"
                  "0.0290\n"
                  "0.0286\n"
                  "0.0271\n"
                  "0.0263\n"
                  "0.0252\n"
                  "0.0263\n"
                  "0.0278\n"
                  "0.0286\n"
                  "0.0297\n"
                  "0.0290\n"
                  "0.0286\n"
                  "0.0286\n"
                  "0.0278\n"
                  "0.0271\n"
                  "0.0278\n"
                  "0.0274\n"
                  "0.0278\n"
                  "0.0271\n"
                  "0.0263\n"
                  "0.0271\n"
                  "0.0263\n"
                  "0.0267\n"
                  "0.0267\n"
                  "0.0267\n"
                  "0.0274\n"
                  "0.0278\n"
                  "0.0278\n"
                  "0.0274\n"
                  "0.0267\n"
                  "0.0267\n"
                  "0.0263\n"
                  "0.0278\n"
                  "0.0271\n"
                  "0.0282\n"
                  "0.0278\n"
                  "0.0282\n"
                  "0.0278\n"
                  "0.0278\n"
                  "0.0286\n"
                  "0.0271\n"
                  "0.0267\n"
                  "0.0255\n"
                  "0.0263\n"
                  "0.0274\n"
                  "0.0286\n"
                  "0.0293\n"
                  "0.0286\n"
                  "0.0271\n"
                  "0.0259\n"
                  "0.0252\n"
                  "0.0248\n"
                  "0.0252\n"
                  "0.0248\n"
                  "0.0244\n"
                  "0.0252\n"
                  "0.0255\n"
                  "0.0252\n"
                  "0.0244\n"
                  "0.0248\n"
                  "0.0248\n"
                  "0.0244\n"
                  "0.0252\n"
                  "0.0255\n"
                  "0.0244\n"
                  "0.0236\n"
                  "0.0240\n"
                  "0.0244\n"
                  "0.0252\n"
                  "0.0255\n"
                  "0.0267\n"
                  "0.0267\n"
                  "0.0271\n"
                  "0.0259\n"
                  "0.0263\n"
                  "0.0255\n"
                  "0.0259\n"
                  "0.0255\n"
                  "0.0259\n"
                  "0.0259\n"
                  "0.0252\n"
                  "0.0252\n"
                  "0.0259\n"
                  "0.0274\n"
                  "0.0274\n"
                  "0.0274\n"
                  "0.0267\n"
                  "0.0267\n"
                  "0.0267\n"
                  "0.0278\n"
                  "0.0278\n"
                  "0.0278\n"
                  "0.0282\n"
                  "0.0286\n"
                  "0.0293\n"
                  "0.0286\n"
                  "0.0282\n"
                  "0.0271\n"
                  "0.0278\n"
                  "0.0274\n"
                  "0.0278\n"
                  "0.0286\n"
                  "0.0286\n"
                  "0.0290\n"
                  "0.0290\n"
                  "0.0297\n"
                  "0.0309\n"
                  "0.0301\n"
                  "0.0313\n"
                  "0.0313\n"
                  "0.0313\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0309\n"
                  "0.0305\n"
                  "0.0309\n"
                  "0.0313\n"
                  "0.0305\n"
                  "0.0309\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0313\n"
                  "0.0305\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0309\n"
                  "0.0309\n"
                  "0.0309\n"
                  "0.0305\n"
                  "0.0309\n"
                  "0.0309\n"
                  "0.0320\n"
                  "0.0324\n"
                  "0.0316\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0309\n"
                  "0.0305\n"
                  "0.0297\n"
                  "0.0293\n"
                  "0.0286\n"
                  "0.0286\n"
                  "0.0293\n"
                  "0.0290\n"
                  "0.0286\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0293\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0278\n"
                  "0.0278\n"
                  "0.0286\n"
                  "0.0293\n"
                  "0.0293\n"
                  "0.0293\n"
                  "0.0293\n"
                  "0.0286\n"
                  "0.0282\n"
                  "0.0286\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0286\n"
                  "0.0286\n"
                  "0.0297\n"
                  "0.0278\n"
                  "0.0274\n"
                  "0.0274\n"
                  "0.0278\n"
                  "0.0290\n"
                  "0.0297\n"
                  "0.0301\n"
                  "0.0293\n"
                  "0.0297\n"
                  "0.0301\n"
                  "0.0309\n"
                  "0.0305\n"
                  "0.0305\n"
                  "0.0305\n"
                  "0.0305\n"
                  "0.0297\n"
                  "0.0286\n"
                  "0.0293\n"
                  "0.0301\n"
                  "0.0297\n"
                  "0.0293\n"
                  "0.0293\n"
                  "0.0301\n"
                  "0.0297\n"
                  "0.0293\n"
                  "0.0297\n"
                  "0.0290\n"
                  "0.0290\n"
                  "0.0305\n"
                  "0.0305\n"
                  "0.0305\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0293\n"
                  "0.0297\n"
                  "0.0290\n"
                  "0.0286\n"
                  "0.0286\n"
                  "0.0282\n"
                  "0.0286\n"
                  "0.0274\n"
                  "0.0290\n"
                  "0.0286\n"
                  "0.0293\n"
                  "0.0297\n"
                  "0.0297\n"
                  "0.0293\n"
                  "0.0293\n"
                  "0.0301\n"
                  "0.0297\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0309\n"
                  "0.0320\n"
                  "0.0320\n"
                  "0.0316\n"
                  "0.0316\n"
                  "0.0316\n"
                  "0.0320\n"
                  "0.0309\n"
                  "0.0301\n"
                  "0.0305\n"
                  "0.0309\n"
                  "0.0316\n"
                  "0.0320\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0293\n"
                  "0.0297\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0305\n"
                  "0.0309\n"
                  "0.0301\n"
                  "0.0313\n"
                  "0.0297\n"
                  "0.0301\n"
                  "0.0313\n"
                  "0.0320\n"
                  "0.0324\n"
                  "0.0320\n"
                  "0.0320\n"
                  "0.0316\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0309\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0324\n"
                  "0.0320\n"
                  "0.0313\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0293\n"
                  "0.0301\n"
                  "0.0309\n"
                  "0.0313\n"
                  "0.0328\n"
                  "0.0339\n"
                  "0.0332\n"
                  "0.0335\n"
                  "0.0328\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0316\n"
                  "0.0309\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0320\n"
                  "0.0320\n"
                  "0.0313\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0301\n"
                  "0.0309\n"
                  "0.0305\n"
                  "0.0316\n"
                  "0.0316\n"
                  "0.0301\n"
                  "0.0290\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0286\n"
                  "0.0290\n"
                  "0.0293\n"
                  "0.0297\n"
                  "0.0297\n"
                  "0.0286\n"
                  "0.0301\n"
                  "0.0297\n"
                  "0.0293\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0297\n"
                  "0.0305\n"
                  "0.0313\n"
                  "0.0316\n"
                  "0.0313\n"
                  "0.0301\n"
                  "0.0301\n"
                  "0.0309\n"
                  "0.0309\n"
                  "0.0309\n"
                  "0.0320\n"
                  "0.0328\n"
                  "0.0335\n"
                  "0.0339\n"
                  "0.0328\n"
                  "0.0343\n"
                  "0.0328\n"
                  "0.0328\n"
                  "0.0335\n"
                  "0.0339\n"
                  "0.0332\n"
                  "0.0343\n"
                  "0.0343\n"
                  "0.0339\n"
                  "0.0335\n"
                  "0.0328\n"
                  "0.0328\n"
                  "0.0324\n"
                  "0.0324\n"
                  "0.0324\n"
                  "0.0313\n"
                  "0.0316\n"
                  "0.0309\n"
                  "0.0297\n"
                  "0.0297\n"
                  "0.0305\n"
                  "0.0305\n"
                  "0.0301\n"
                  "0.0305\n"
                  "0.0297\n"
                  "0.0297\n"
                  "0.0297\n"
                  "0.0290\n"
                  "0.0282\n"
                  "0.0267\n"
                  "0.0271\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0282\n"
                  "0.0278\n"
                  "0.0274\n"
                  "0.0259\n"
                  "0.0259\n"
                  "0.0255\n"
                  "0.0271\n"
                  "0.0278\n"
                  "0.0282\n"
                  "0.0290\n"
                  "0.0297\n"
                  "0.0332\n"
                  "0.0373\n"
                  "0.0381\n"
                  "0.0370\n"
                  "0.0377\n"
                  "0.0431\n"
                  "0.0442\n"
                  "0.0438\n"
                  "0.0541\n"
                  "0.0556\n"
                  "0.0602\n"
                  "0.0610\n"
                  "0.0652\n"
                  "0.0667\n"
                  "0.0667\n"
                  "0.0671\n"
                  "0.0701\n"
                  "0.0720\n"
                  "0.0713\n"
                  "0.0762\n"
                  "0.0781\n"
                  "0.0774\n"
                  "0.0823\n"
                  "0.0846\n"
                  "0.0865\n"
                  "0.0877\n"
                  "0.0945\n"
                  "0.0949\n"
                  "0.0957\n"
                  "0.0957\n"
                  "0.1014\n"
                  "0.1033\n"
                  "0.1037\n"
                  "0.1063\n"
                  "0.1059\n"
                  "0.1056\n"
                  "0.1048\n"
                  "0.1090\n"
                  "0.1071\n"
                  "0.1075\n"
                  "0.1109\n"
                  "0.1124\n"
                  "0.1109\n"
                  "0.1212\n"
                  "0.1246\n"
                  "0.1273\n"
                  "0.1212\n"
                  "0.1273\n"
                  "0.1277\n"
                  "0.1284\n"
                  "0.1288\n"
                  "0.1242\n"
                  "0.1242\n"
                  "0.1216\n"
                  "0.1197\n"
                  "0.1242\n"
                  "0.1269\n"
                  "0.1307\n"
                  "0.1364\n"
                  "0.1444\n"
                  "0.1418\n"
                  "0.1441\n"
                  "0.1463\n"
                  "0.1463\n"
                  "0.1532\n"
                  "0.1536\n"
                  "0.1551\n"
                  "0.1646\n"
                  "0.1643\n"
                  "0.1654\n"
                  "0.1654\n"
                  "0.1604\n"
                  "0.1593\n"
                  "0.1631\n"
                  "0.1616\n"
                  "0.1684\n"
                  "0.1704\n"
                  "0.1730\n"
                  "0.1688\n"
                  "0.1742\n"
                  "0.1757\n"
                  "0.1738\n"
                  "0.1822\n"
                  "0.1810\n"
                  "0.1734\n"
                  "0.1749\n"
                  "0.1761\n"
                  "0.1795\n"
                  "0.1726\n"
                  "0.1730\n"
                  "0.1639\n"
                  "0.1646\n"
                  "0.1643\n"
                  "0.1696\n"
                  "0.1681\n"
                  "0.1696\n"
                  "0.1688\n"
                  "0.1665\n"
                  "0.1623\n"
                  "0.1589\n"
                  "0.1608\n"
                  "0.1631\n"
                  "0.1635\n"
                  "0.1662\n"
                  "0.1681\n"
                  "0.1662\n"
                  "0.1654\n"
                  "0.1692\n"
                  "0.1563\n"
                  "0.1574\n"
                  "0.1589\n"
                  "0.1582\n"
                  "0.1601\n"
                  "0.1635\n"
                  "0.1608\n"
                  "0.1639\n"
                  "0.1692\n"
                  "0.1745\n"
                  "0.1799\n"
                  "0.1833\n"
                  "0.1787\n"
                  "0.1814\n"
                  "0.1883\n"
                  "0.1772\n"
                  "0.1833\n"
                  "0.1806\n"
                  "0.1757\n"
                  "0.1753\n"
                  "0.1772\n"
                  "0.1803\n"
                  "0.1875\n"
                  "0.1879\n"
                  "0.1871\n"
                  "0.1875\n"
                  "0.1852\n"
                  "0.1909\n"
                  "0.1913\n"
                  "0.1905\n"
                  "0.1993\n"
                  "0.1974\n"
                  "0.1932\n"
                  "0.1875\n"
                  "0.1833\n"
                  "0.1902\n"
                  "0.1936\n"
                  "0.1883\n"
                  "0.1837\n"
                  "0.1841\n"
                  "0.1841\n"
                  "0.1803\n"
                  "0.1795\n"
                  "0.1803\n"
                  "0.1810\n"
                  "0.1856\n"
                  "0.1856\n"
                  "0.1860\n"
                  "0.1867\n"
                  "0.1852\n"
                  "0.1814\n"
                  "0.1814\n"
                  "0.1845\n"
                  "0.1837\n"
                  "0.1852\n"
                  "0.1761\n"
                  "0.1814\n"
                  "0.1814\n"
                  "0.1841\n"
                  "0.1974\n"
                  "0.2050\n"
                  "0.2088\n"
                  "0.2081\n"
                  "0.2149\n"
                  "0.2146\n"
                  "0.2149\n"
                  "0.2222\n"
                  "0.2260\n"
                  "0.2237\n"
                  "0.2386\n"
                  "0.2386\n"
                  "0.2309\n"
                  "0.2302\n"
                  "0.2302\n"
                  "0.2260\n"
                  "0.2294\n"
                  "0.2317\n"
                  "0.2325\n"
                  "0.2378\n"
                  "0.2351\n"
                  "0.2374\n"
                  "0.2382\n"
                  "0.2389\n"
                  "0.2397\n"
                  "0.2370\n"
                  "0.2367\n"
                  "0.2428\n"
                  "0.2416\n"
                  "0.2416\n"
                  "0.2378\n"
                  "0.2321\n"
                  "0.2329\n"
                  "0.2268\n"
                  "0.2203\n"
                  "0.2210\n"
                  "0.2153\n"
                  "0.2188\n"
                  "0.2134\n"
                  "0.2088\n"
                  "0.2069\n"
                  "0.1982\n"
                  "0.1928\n"
                  "0.1932\n"
                  "0.2005\n"
                  "0.1982\n"
                  "0.2050\n"
                  "0.2039\n"
                  "0.2039\n"
                  "0.2031\n"
                  "0.2012\n"
                  "0.1845\n"
                  "0.1825\n"
                  "0.1852\n"
                  "0.1867\n"
                  "0.1871\n"
                  "0.1875\n"
                  "0.1883\n"
                  "0.1818\n"
                  "0.1749\n"
                  "0.1684\n"
                  "0.1688\n"
                  "0.1700\n"
                  "0.1646\n"
                  "0.1684\n"
                  "0.1665\n"
                  "0.1639\n"
                  "0.1700\n"
                  "0.1574\n"
                  "0.1574\n"
                  "0.1563\n"
                  "0.1563\n"
                  "0.1559\n"
                  "0.1612\n"
                  "0.1635\n"
                  "0.1654\n"
                  "0.1662\n"
                  "0.1654\n"
                  "0.1673\n"
                  "0.1650\n"
                  "0.1639\n"
                  "0.1658\n"
                  "0.1719\n"
                  "0.1734\n"
                  "0.1654\n"
                  "0.1604\n"
                  "0.1505\n"
                  "0.1582\n"
                  "0.1681\n"
                  "0.1658\n"
                  "0.1608\n"
                  "0.1715\n"
                  "0.1719\n"
                  "0.1776\n"
                  "0.1734\n"
                  "0.1723\n"
                  "0.1726\n"
                  "0.1730\n"
                  "0.1700\n"
                  "0.1658\n"
                  "0.1681\n"
                  "0.1757\n"
                  "0.1780\n"
                  "0.1753\n"
                  "0.1780\n"
                  "0.1734\n"
                  "0.1764\n"
                  "0.1780\n"
                  "0.1772\n"
                  "0.1818\n"
                  "0.1833\n"
                  "0.1845\n"
                  "0.1852\n"
                  "0.1848\n"
                  "0.1761\n"
                  "0.1723\n"
                  "0.1704\n"
                  "0.1711\n"
                  "0.1715\n"
                  "0.1711\n"
                  "0.1787\n"
                  "0.1818\n"
                  "0.1875\n"
                  "0.1860\n"
                  "0.1784\n"
                  "0.1845\n"
                  "0.1829\n"
                  "0.1902\n"
                  "0.1795\n"
                  "0.1742\n"
                  "0.1730\n"
                  "0.1795\n"
                  "0.1749\n"
                  "0.1768\n"
                  "0.1795\n"
                  "0.1799\n"
                  "0.1791\n"
                  "0.1787\n"
                  "0.1784\n"
                  "0.1879\n"
                  "0.1875\n"
                  "0.1875\n"
                  "0.1928\n"
                  "0.1974\n"
                  "0.2005\n"
                  "0.2050\n"
                  "0.2130\n"
                  "0.2138\n"
                  "0.2138\n"
                  "0.2195\n"
                  "0.2233\n"
                  "0.2195\n"
                  "0.2191\n"
                  "0.2180\n"
                  "0.2138\n"
                  "0.2130\n"
                  "0.2245\n"
                  "0.2298\n"
                  "0.2397\n"
                  "0.2447\n"
                  "0.2443\n"
                  "0.2393\n"
                  "0.2348\n"
                  "0.2332\n"
                  "0.2271\n"
                  "0.2275\n"
                  "0.2237\n"
                  "0.2218\n"
                  "0.2184\n"
                  "0.2153\n"
                  "0.2149\n"
                  "0.2107\n"
                  "0.2058\n"
                  "0.2024\n"
                  "0.2005\n"
                  "0.1913\n"
                  "0.1936\n"
                  "0.1982\n"
                  "0.1997\n"
                  "0.2127\n"
                  "0.2031\n"
                  "0.2115\n"
                  "0.2107\n"
                  "0.1982\n"
                  "0.1913\n"
                  "0.1890\n"
                  "0.1822\n"
                  "0.1768\n"
                  "0.1738\n"
                  "0.1780\n"
                  "0.1684\n"
                  "0.1604\n"
                  "0.1616\n"
                  "0.1601\n"
                  "0.1612\n"
                  "0.1669\n"
                  "0.1707\n"
                  "0.1696\n"
                  "0.1726\n"
                  "0.1627\n"
                  "0.1616\n"
                  "0.1673\n"
                  "0.1749\n"
                  "0.1784\n"
                  "0.1764\n"
                  "0.1742\n"
                  "0.1742\n"
                  "0.1715\n"
                  "0.1700\n"
                  "0.1696\n"
                  "0.1723\n"
                  "0.1742\n"
                  "0.1753\n"
                  "0.1719\n"
                  "0.1696\n"
                  "0.1711\n"
                  "0.1787\n"
                  "0.1825\n"
                  "0.1791\n"
                  "0.1822\n"
                  "0.1742\n"
                  "0.1787\n"
                  "0.1704\n"
                  "0.1730\n"
                  "0.1753\n"
                  "0.1780\n"
                  "0.1825\n"
                  "0.1848\n"
                  "0.1871\n"
                  "0.1905\n"
                  "0.1902\n"
                  "0.1951\n"
                  "0.2001\n"
                  "0.2024\n"
                  "0.2077\n"
                  "0.2111\n"
                  "0.2054\n"
                  "0.2012\n"
                  "0.1905\n"
                  "0.1852\n"
                  "0.1848\n"
                  "0.1833\n"
                  "0.1745\n"
                  "0.1669\n"
                  "0.1623\n"
                  "0.1623\n"
                  "0.1639\n"
                  "0.1620\n"
                  "0.1627\n"
                  "0.1669\n"
                  "0.1612\n"
                  "0.1563\n"
                  "0.1509\n"
                  "0.1498\n"
                  "0.1494\n"
                  "0.1475\n"
                  "0.1486\n"
                  "0.1437\n"
                  "0.1372\n"
                  "0.1372\n"
                  "0.1349\n"
                  "0.1326\n"
                  "0.1349\n"
                  "0.1338\n"
                  "0.1296\n"
                  "0.1284\n"
                  "0.1296\n"
                  "0.1242\n"
                  "0.1189\n"
                  "0.1155\n"
                  "0.1139\n"
                  "0.1124\n"
                  "0.1075\n"
                  "0.1037\n"
                  "0.0987\n"
                  "0.0953\n"
                  "0.0903\n"
                  "0.0915\n"
                  "0.0918\n"
                  "0.0930\n"
                  "0.0918\n"
                  "0.0934\n"
                  "0.0945\n"
                  "0.0953\n"
                  "0.0918\n"
                  "0.0972\n"
                  "0.0930\n"
                  "0.1006\n"
                  "0.1075\n"
                  "0.1101\n"
                  "0.1105\n"
                  "0.1113\n"
                  "0.1113\n"
                  "0.1113\n"
                  "0.1120\n"
                  "0.1124\n"
                  "0.1136\n"
                  "0.1101\n"
                  "0.1094\n"
                  "0.1094\n"
                  "0.1086\n"
                  "0.1079\n"
                  "0.1052\n"
                  "0.0968\n"
                  "0.1010\n"
                  "0.1014\n"
                  "0.1067\n"
                  "0.1086\n"
                  "0.1155\n"
                  "0.1250\n"
                  "0.1307\n"
                  "0.1296\n"
                  "0.1280\n"
                  "0.1261\n"
                  "0.1258\n"
                  "0.1269\n"
                  "0.1265\n"
                  "0.1265\n"
                  "0.1250\n"
                  "0.1246\n"
                  "0.1231\n"
                  "0.1220\n"
                  "0.1212\n"
                  "0.1174\n"
                  "0.1151\n"
                  "0.1155\n"
                  "0.1117\n"
                  "0.1113\n"
                  "0.1029\n"
                  "0.0968\n"
                  "0.0938\n"
                  "0.0888\n"
                  "0.0888\n"
                  "0.0888\n"
                  "0.0877\n"
                  "0.0873\n"
                  "0.0869\n"
                  "0.0865\n"
                  "0.0861\n"
                  "0.0842\n"
                  "0.0850\n"
                  "0.0854\n"
                  "0.0835\n"
                  "0.0835\n"
                  "0.0838\n"
                  "0.0781\n"
                  "0.0762\n"
                  "0.0690\n"
                  "0.0659\n"
                  "0.0572\n"
                  "0.0495\n"
                  "0.0450\n"
                  "0.0438\n"
                  "0.0423\n"
                  "0.0419\n"
                  "0.0404\n"
                  "0.0400\n"
                  "0.0396\n"
                  "0.0396\n"
                  "0.0408\n"
                  "0.0412\n"
                  "0.0415\n"
                  "0.0408\n"
                  "0.0389\n"
                  "0.0389\n"
                  "0.0385\n"
                  "0.0400\n"
                  "0.0396\n"
                  "0.0393\n"
                  "0.0389\n"
                  "0.0385\n"
                  "0.0370\n"
                  "0.0373\n"
                  "0.0377";

int DataProcessor_Initialize(){
    printf("Initializing Linked List... \r\n");

    lp = (List *) malloc(sizeof(List));
    initList(lp);

    printf("Initialized Linked List \r\n");

}

int DataProcessor_ReadData(){
    printf("Reading data..\r\n");
    char* pch = NULL;

    pch = strtok(mock_csv, "\n");

    while (pch != NULL)
    {
        addAtTail(lp, atof(pch));
        pch = strtok(NULL, "\n");
    }
    printf("Done reading data..\r\n");

    return 0;
}

int DataProcessor_ProcessData(){
    //TODO: Absolute value and moving average
}

//TODO: Check initial hand position (physical)
int DataProcessor_CheckThreshold(){ //TODO: Check head is not null
    printf("Checking threshold..\r\n");
    Node *n = lp->head;
    printf("Head: %f\n", lp->head->item);

    int isClenched;


    if(n->item >= THRESHOLD){
        DataProcessor_CompleteAction(CLENCH);
        isClenched = 1;
    } else {
        DataProcessor_CompleteAction(RELEASE);
        isClenched = 0;
    }

    while (n->next){ //TODO: not addressing last values
        if(n->item >= THRESHOLD && isClenched == 0){
            DataProcessor_CompleteAction(CLENCH);
            isClenched = 1;
        } else if(n->item < THRESHOLD && isClenched == 1){
            DataProcessor_CompleteAction(RELEASE);
            isClenched = 0;
        }
        n = n->next;
        HAL_Delay(10);
    }
}

int DataProcessor_CompleteAction(int action){
    if(action == 1){
        printf("CLENCHING\r\n");
        char *arg = "4";
        char* arguments[5];
        arguments[0] = arg;

        CommandHandler_ServoClench(arguments);
    } else {
        printf("RELEASING\r\n");
        char *arg = "4";
        char* arguments[5];
        arguments[0] = arg;

        CommandHandler_ServoRelease(arguments);
    }
}